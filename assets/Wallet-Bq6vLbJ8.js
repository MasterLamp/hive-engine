import{o as a,d as r,f as e,b4 as O,c as H,a as V,i as c,j as q,Q as W,r as x,n as Y,b0 as z,G as D,H as T,w as h,b as M,h as $,F as g,e as C,t as l,k as S,v as A,_ as N,K as L,s as F,P as j,b8 as P,y as Z,a5 as E}from"./index-CCPLilNe.js";import{_ as U}from"./LoadingOverlay-CxOz52n3.js";function I(b,p){return a(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4.5v15m7.5-7.5h-15"})])}function Ue(b,p){return a(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 10.5V6a3.75 3.75 0 1 0-7.5 0v4.5m11.356-1.993 1.263 12c.07.665-.45 1.243-1.119 1.243H4.25a1.125 1.125 0 0 1-1.12-1.243l1.264-12A1.125 1.125 0 0 1 5.513 7.5h12.974c.576 0 1.059.435 1.119 1.007ZM8.625 10.5a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm7.5 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"})])}const R=["disabled"],je={__name:"AddToCart",props:{card:{type:Object,required:!0}},setup(b){const p=O(),i=b,n=H(()=>p.cart.find(v=>v.uid===i.card.uid));return(v,d)=>(a(),r("button",{disabled:!c(p).isLoggedIn||c(p).player===b.card.seller,class:W(["btn-sm",{"bg-red-900 hover:bg-red-900":n.value}]),onClick:d[0]||(d[0]=y=>c(p).toggleCart(b.card))},[n.value?(a(),V(c(q),{key:0,class:"h-5 w-5"})):(a(),V(c(I),{key:1,class:"h-5 w-5"}))],10,R))}},G={class:"grid grid-cols-3 gap-4"},K={class:"col-span-3"},Q={class:"text-sm"},X={class:"text-sm"},J={class:"text-xs"},ee={class:"col-span-2 self-center text-right"},te={class:"col-span-1 self-center text-right"},se=["onClick"],ae={class:"mx-auto mt-10 max-w-[150px]"},oe={class:"flex items-center"},le={class:"mt-10 flex flex-wrap items-center justify-between gap-4"},ne={class:"flex flex-wrap gap-4"},re={class:"flex items-center gap-2"},ie=["disabled","onClick"],ce={key:1,class:"mb-10 pt-5 text-center text-xl font-bold"},qe={__name:"Cart",setup(b){const p=x(!1),i=x(!0),n=O(),v=Y("eventBus"),d=x(2),y=H(()=>{const _=n.cart.reduce((s,t)=>(s[t.currency]||(s[t.currency]=new z(0)),s[t.currency]=s[t.currency].add(t.price),s),{});return Object.entries(_).map(s=>[s[0],s[1].mul(d.value).toNumber()])}),m=async()=>{i.value=!0,await n.fetchBalances(),i.value=!1},k=({eventData:_})=>{n.cart=n.cart.filter(s=>!_.includes(s.uid))};return D(()=>{v.on("rent-cards-successful",k)}),T(()=>{v.off("rent-cards-successful",k)}),(_,s)=>(a(),V(N,{modelValue:p.value,"onUpdate:modelValue":s[1]||(s[1]=t=>p.value=t),size:"xl",name:"cartModal",onBeforeOpen:m},{title:h(()=>s[2]||(s[2]=[M("Cart")])),default:h(()=>[$(U,{show:i.value},{default:h(()=>[c(n).cart.length>0?(a(),r(g,{key:0},[e("div",G,[(a(!0),r(g,null,C(c(n).cart,t=>(a(),r("div",{key:t.uid,class:"grid grid-cols-6 gap-2"},[e("div",K,[e("div",{class:W(["font-bold",{"text-yellow-500":t.gold}])},l(t.name),3),e("div",Q,l(t.uid),1),e("div",X,[M(" Level "+l(t.level)+" ",1),e("span",J,"("+l(t.bcx)+" BCX)",1)])]),e("div",ee,l(Number(t.price))+" "+l(t.currency),1),e("div",te,[e("button",{onClick:f=>c(n).toggleCart(t)},[$(c(q),{class:"h-5 w-5 text-red-500"})],8,se)])]))),128))]),e("div",ae,[e("div",oe,[S(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>d.value=t),type:"number",min:"2",max:"180",class:"!rounded-r-none border-r-0"},null,512),[[A,d.value]]),s[3]||(s[3]=e("div",{class:"self-stretch rounded-r-md border px-2 py-2 dark:border-gray-500 dark:bg-slate-600"},"Days",-1))])]),e("div",le,[e("div",null,[s[4]||(s[4]=e("h3",{class:"font-bold"},"Your balances:",-1)),e("div",ne,[(a(!0),r(g,null,C(c(n).balances,t=>(a(),r("div",{key:t},l(t[1])+" "+l(t[0]),1))),128))])]),e("div",re,[(a(!0),r(g,null,C(y.value,t=>(a(),r("button",{key:t[0],class:"btn",disabled:d.value<2||d.value>180||!c(n).balances.has(t[0])||c(n).balances.get(t[0])<t[1],onClick:f=>c(n).requestPayment({currency:t[0],days:d.value})},l(t[1])+" "+l(t[0]),9,ie))),128))])])],64)):(a(),r("div",ce,"No items found!"))]),_:1},8,["show"])]),_:1},8,["modelValue"]))}},ue={class:"mb-5 w-full table-auto"},de={class:"px-4 py-2 first-of-type:text-left last-of-type:text-right"},pe={class:"px-4 py-2 first-of-type:text-left last-of-type:text-right"},fe={class:"px-4 py-2 first-of-type:text-left last-of-type:text-right"},ve={class:"px-4 py-2 first-of-type:text-left last-of-type:text-right"},ye={class:"px-4 py-2 first-of-type:text-left last-of-type:text-right"},me={key:1},xe={__name:"BalanceHistory",setup(b){const p=x(!1),i=x(!1),n=O(),v=x([]),d=x(""),y=x(1),m=async()=>{i.value=!0;const s=await n.fetchBalanceHistory({page:y.value,currency:d.value});v.value.push(...s),i.value=!1},k=async s=>{const{currency:t}=s.ref.params.value;d.value=t,await m()},_=()=>{v.value=[]};return(s,t)=>(a(),V(N,{modelValue:p.value,"onUpdate:modelValue":t[0]||(t[0]=f=>p.value=f),size:"lg",name:"balanceHistoryModal",onBeforeOpen:k,onClosed:_},{title:h(({params:f})=>[M("Balance History: "+l(f.currency),1)]),default:h(()=>[$(U,{show:i.value},{default:h(()=>[e("table",ue,[t[2]||(t[2]=e("thead",null,[e("tr",null,[e("th",{class:"px-4 py-2 text-left last-of-type:text-right"},"Username"),e("th",{class:"px-4 py-2 text-left last-of-type:text-right"},"Amount"),e("th",{class:"px-4 py-2 text-left last-of-type:text-right"},"Balance"),e("th",{class:"px-4 py-2 text-left last-of-type:text-right"},"Type"),e("th",{class:"px-4 py-2 text-left last-of-type:text-right"},"Date")])],-1)),e("tbody",null,[v.value.length>0?(a(!0),r(g,{key:0},C(v.value,(f,B)=>(a(),r("tr",{key:B},[e("td",de,l(f.username),1),e("td",pe,l(f.amount),1),e("td",fe,l(f.balance_end),1),e("td",ve,l(f.type),1),e("td",ye,l(new Date(f.timestamp).toLocaleString()),1)]))),128)):(a(),r("tr",me,t[1]||(t[1]=[e("td",{colspan:"6",class:"px-4 py-2 text-center"},"You do have any history.",-1)])))])])]),_:1},8,["show"])]),_:1},8,["modelValue"]))}},_e={class:"mb-5 w-full table-auto"},he={class:"px-4 py-2 first-of-type:text-left last-of-type:text-right"},be={class:"px-4 py-2 first-of-type:text-left last-of-type:text-right"},ge={class:"px-4 py-2 first-of-type:text-left last-of-type:text-right"},we=["onClick"],ke={key:1},$e={class:"mb-3 grid grid-cols-2 gap-3"},Ce=["value"],Be={class:"mb-3 grid grid-cols-2 gap-3"},Ve=["disabled"],Me=["disabled"],Oe={class:"text-sm"},We={__name:"Wallet",setup(b){const p=L(),i=O(),n=F(),v=x(!1),d=x(!0),y=x(""),m=x(i.settings.currencies[0]),k=new Map(i.settings.precisions),_=H(()=>{const w=n.wallet.find(o=>o.symbol===m.value);return w?w.balance.toNumber():0}),s=async w=>{const o=Z(y.value,k.get(m.value)),u=w==="deposit"?w:`withdraw ${o}`;await n.requestTransfer({to:i.settings.account,quantity:w==="deposit"?o:"0.001",symbol:m.value,memo:u,eventName:"hesl-wallet-action-successful"})},t=async()=>{d.value=!0,await Promise.all([i.fetchBalances(),n.fetchWallet()]),d.value=!1},f=()=>{y.value=""},B=async()=>{d.value=!0,f(),await E(20*1e3),await t()};return D(()=>{j.on("hesl-wallet-action-successful",B)}),T(()=>{j.off("hesl-wallet-action-successful",B)}),(w,o)=>(a(),r(g,null,[$(N,{modelValue:v.value,"onUpdate:modelValue":o[4]||(o[4]=u=>v.value=u),name:"heslWalletModal",onBeforeOpen:t,onClosed:f},{title:h(()=>o[5]||(o[5]=[M("Wallet")])),default:h(()=>[$(U,{show:d.value},{default:h(()=>[o[7]||(o[7]=e("h3",{class:"mb-3 text-center text-lg font-bold"},"Your Balances",-1)),e("table",_e,[e("tbody",null,[c(i).balances.size>0?(a(!0),r(g,{key:0},C(c(i).balances,u=>(a(),r("tr",{key:u},[e("td",he,l(u[0]),1),e("td",be,l(u[1]),1),e("td",ge,[e("button",{onClick:Se=>c(p).open("balanceHistoryModal",{currency:u[0]})},"History",8,we)])]))),128)):(a(),r("tr",ke,o[6]||(o[6]=[e("td",{class:"px-4 py-2 text-center"},"You do have any balances.",-1)])))])]),e("div",$e,[S(e("input",{"onUpdate:modelValue":o[0]||(o[0]=u=>y.value=u),type:"number",min:"1"},null,512),[[A,y.value]]),S(e("select",{"onUpdate:modelValue":o[1]||(o[1]=u=>m.value=u)},[(a(!0),r(g,null,C(c(i).settings.currencies,u=>(a(),r("option",{key:u,value:u},l(u),9,Ce))),128))],512),[[P,m.value]])]),e("div",Be,[e("button",{class:"btn",disabled:y.value<=0||_.value<y.value,onClick:o[2]||(o[2]=u=>s("deposit"))}," Deposit ",8,Ve),e("button",{class:"btn",disabled:y.value<=0||_.value<.001||!c(i).balances.has(m.value)||c(i).balances.get(m.value)<y.value,onClick:o[3]||(o[3]=u=>s("withdraw"))}," Withdraw ",8,Me)]),e("div",Oe,"You have "+l(_.value)+" "+l(m.value)+" in you Hive-Engine wallet.",1)]),_:1},8,["show"])]),_:1},8,["modelValue"]),$(xe)],64))}};export{je as _,We as a,qe as b,Ue as r};
