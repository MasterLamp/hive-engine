const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/WalletAction-s08lvw5C.js","assets/index-CCPLilNe.js","assets/index-Rzzs60cW.css","assets/CustomTable-ruclgATk.js","assets/Deposit-BzQN-pc-.js","assets/_commonjsHelpers-BosuxZz1.js","assets/v5-BwXzlfux.js","assets/SearchSelect-BZ1OkDwa.js","assets/SearchSelect-BrO5TmPb.css","assets/Withdraw-DE3LgMjj.js","assets/TokenInfo-OC2gi9hD.js","assets/Announcements-CNEy_u4Y.js"])))=>i.map(i=>d[i]);
import{o as a,d as l,f as s,U as xe,r as W,K as Ce,T as J,u as Me,q as Se,x as Ve,s as $e,aY as Te,c as u,A as K,V as Ue,G as Ee,H as Pe,t as p,i,g as b,a as Q,F as X,e as De,L as Ae,k as S,v as Be,J as ee,b1 as te,b as y,h as r,b2 as Ie,w as m,a6 as H,Q as Le,X as We,n as He,a0 as Oe,p as Re,b0 as ne,y as je,z as se,a2 as V,I as ae,b3 as Fe,a3 as $,a4 as T}from"./index-CCPLilNe.js";import{_ as Ne}from"./CustomTable-ruclgATk.js";import{r as Ze}from"./InformationCircleIcon-DdWn0APd.js";import{r as qe}from"./ArrowsRightLeftIcon-BnK6nU6-.js";function ze(v,k){return a(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"})])}function Ge(v,k){return a(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.25 6 9 12.75l4.286-4.286a11.948 11.948 0 0 1 4.306 6.43l.776 2.898m0 0 3.182-5.511m-3.182 5.51-5.511-3.181"})])}function Ye(v,k){return a(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.25 18 9 11.25l4.306 4.306a11.95 11.95 0 0 1 5.814-5.518l2.74-1.22m0 0-5.94-2.281m5.94 2.28-2.28 5.941"})])}function Je(v,k){return a(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.75 6.75h16.5M3.75 12H12m-8.25 5.25h16.5"})])}function Ke(v,k){return a(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m3.75 13.5 10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75Z"})])}function Qe(v,k){return a(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.5 10.5V6.75a4.5 4.5 0 1 0-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 0 0 2.25-2.25v-6.75a2.25 2.25 0 0 0-2.25-2.25H6.75a2.25 2.25 0 0 0-2.25 2.25v6.75a2.25 2.25 0 0 0 2.25 2.25Z"})])}function Xe(v,k){return a(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M13.5 10.5V6.75a4.5 4.5 0 1 1 9 0v3.75M3.75 21.75h10.5a2.25 2.25 0 0 0 2.25-2.25v-6.75a2.25 2.25 0 0 0-2.25-2.25H3.75a2.25 2.25 0 0 0-2.25 2.25v6.75a2.25 2.25 0 0 0 2.25 2.25Z"})])}const et={class:"page-header"},tt={class:"mx-auto w-full max-w-7xl px-2 text-gray-200 sm:px-6 lg:px-8"},nt={class:"grid min-h-[160px] items-center text-center md:grid-cols-4 md:text-left"},st={class:"col-span-full md:col-span-3"},at={class:"text-4xl uppercase"},ot={key:0,class:"text-lg"},lt={class:"col-span-full md:col-span-1"},it=["disabled"],rt=["disabled"],ct={key:1,class:"page-content"},dt={key:0,class:"alert-warning"},ut=["onClick"],mt={class:"flex flex-wrap items-center justify-center text-center sm:justify-between sm:text-left"},kt={class:"mb-5"},pt={class:"mb-1 block"},bt={class:"mb-3 block"},vt=["src"],ht={key:0},gt={key:1},_t={key:0},yt={key:1},ft=["onClick"],wt=["onClick"],xt=["onClick"],Ct=["onClick"],Mt=["onClick"],St=["onClick"],Vt=["onClick"],Pt={__name:"WalletView",setup(v){const k=$(()=>T(()=>import("./WalletAction-s08lvw5C.js"),__vite__mapDeps([0,1,2,3]))),oe=$(()=>T(()=>import("./Deposit-BzQN-pc-.js"),__vite__mapDeps([4,1,2,5,6,7,8]))),le=$(()=>T(()=>import("./Withdraw-DE3LgMjj.js"),__vite__mapDeps([9,1,2,7,8]))),ie=$(()=>T(()=>import("./TokenInfo-OC2gi9hD.js"),__vite__mapDeps([10,1,2]))),re=$(()=>T(()=>import("./Announcements-CNEy_u4Y.js"),__vite__mapDeps([11,1,2])));xe({title:"Wallet"});const h=W(!0),ce=Ce(),U=He("eventBus"),O=Oe(),de=Re(),{account:A}=O.params,f=W(""),B=W(!0),E=J("hide-small-balances",!1),w=J("value-includes-all",!1);let R=null;const x=Me(),P=Se(),C=Ve(),M=$e(),ue=Te(),D=u(()=>!C.isLoggedIn||C.username!==A),j=u(()=>new Map(P.tokens.map(n=>[n.symbol,n]))),me=u(()=>new Map(P.metrics.map(n=>[n.symbol,n]))),F=u(()=>M.pendingUnstakes.filter(n=>n.numberTransactionsLeft>1).reduce((n,t)=>{const o=j.value.get(t.symbol);return o&&(n[t.symbol]||(n[t.symbol]=ne(0)),n[t.symbol]=n[t.symbol].plus(t.quantityLeft.minus(je(t.quantity.div(o.numberTransactions).toString(),o.precision)))),n},{})),ke=u(()=>x.hivePrice),N=u(()=>{const n=new RegExp(f.value,"i");return M.wallet.filter(t=>f.value!==""?n.test(t.symbol):!0).map(t=>{const o=j.value.get(t.symbol),c=me.value.get(t.symbol),_=F.value[t.symbol]?F.value[t.symbol].toFixed(o.precision,ne.roundHalfUp):0,e=t.stake.minus(_).toFixed(o.precision),d=c?parseFloat(c.priceChangePercent):0,L=t.balance,Y=t.delegationsOut.plus(t.stake).plus(t.pendingUnstake.minus(_)),fe=c?L.plus(w.value?Y:0).times(c.lastPrice):L.plus(w.value?Y:0),we=se(fe*ke.value);return{...t,token:o,icon:o.icon,symbol:t.symbol,name:o.name,balance:L,pendingUndelegations:Number(t.pendingUndelegations),lockedStake:_,availableStake:e,stakingEnabled:o.stakingEnabled,delegationEnabled:o.delegationEnabled,usdValue:we,changePct:d}}).filter(t=>E.value?t.usdValue>0:!0).sort((t,o)=>o.usdValue-t.usdValue)}),pe=u(()=>se(N.value.reduce((n,t)=>n+t.usdValue,0))),Z=u(()=>{var n,t;return new Map((t=(n=x.settings)==null?void 0:n.delisted_tokens)==null?void 0:t.map(o=>[o.symbol,o]))}),q=u(()=>{const n=Array.from(Z.value.keys());return M.wallet.filter(t=>n.includes(t.symbol)&&t.balance.gt(0))}),be=[{key:"icon",label:""},{key:"symbol",label:"Symbol",sortable:!0},{key:"balance",label:"Balance",sortable:!0},{key:"usdValue",label:"USD Value",sortable:!0},{key:"changePct",label:"% Change",sortable:!0},{key:"stake",label:"Stake"},{key:"delegation",label:"Delegation"},{key:"actions",label:""}],I=async()=>{try{await Promise.all([M.fetchWallet(A),M.fetchPendingUnstakes(),P.fetchTokens(),P.fetchMetrics()])}catch{}},ve=async()=>{B.value&&await I()},z=async({id:n,ntrx:t})=>{h.value=!0,await ce.closeAll(),await x.validateTransaction(t>1?`${n}-0`:n)},G=async()=>{await I(),h.value=!1},he=async()=>{const{open:n}=V({component:oe});await n()},ge=async()=>{const{open:n}=V({component:le});await n()},g=async n=>{const{open:t}=V({component:k,attrs:n});await t()},_e=async n=>{const{open:t}=V({component:ie,attrs:{token:n}});await t()},ye=async n=>{const t=x.settings.announcements.find(o=>{var c;return o.id===((c=Z.value.get(n))==null?void 0:c.announcementId)});if(t){const{open:o}=V({component:re,attrs:t});await o()}};return K(ue,n=>{n==="visible"?B.value=!0:B.value=!1}),K(()=>C.username,async()=>{C.username!==""&&await de.push({name:O.name,params:{account:C.username}})}),Ue(async()=>{h.value=!0,await I(),h.value=!1}),Ee(async()=>{R=setInterval(ve,3*60*1e3),U.on("broadcast-success",z),U.on("transaction-validated",G)}),Pe(()=>{clearInterval(R),U.off("broadcast-success",z),U.off("transaction-validated",G)}),(n,t)=>{const o=ae("Loading"),c=ae("router-link"),_=Fe("tooltip");return a(),l(X,null,[s("div",et,[s("div",tt,[s("div",nt,[s("div",st,[s("h1",at,p(D.value?`@${i(A)}'s`:"My")+" Token Wallet",1),h.value?b("",!0):(a(),l("div",ot,"Estimated value: $"+p(pe.value.toLocaleString())+" USD",1))]),s("div",lt,[s("button",{disabled:D.value,class:"btn mr-3 mt-3",onClick:he},"Deposit",8,it),s("button",{disabled:D.value,class:"btn mt-3",onClick:ge},"Withdraw",8,rt)])])])]),h.value?(a(),Q(o,{key:0})):(a(),l("div",ct,[q.value.length>0?(a(),l("div",dt,[t[4]||(t[4]=s("p",{class:"mb-2"}," You have the following token(s) that are going to be delisted or is delisted. Click the token(s) to read more. ",-1)),(a(!0),l(X,null,De(q.value,e=>(a(),l("a",{key:e.id,class:"block",href:"#",onClick:Ae(d=>ye(e.symbol),["prevent"])},p(e.symbol),9,ut))),128))])):b("",!0),s("div",mt,[s("div",kt,[S(s("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>f.value=e),type:"text",placeholder:"Search tokens",onInput:t[1]||(t[1]=e=>f.value=e.target.value.toUpperCase())},null,544),[[Be,f.value]])]),s("div",null,[s("label",pt,[S(s("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>te(E)?E.value=e:null),type:"checkbox"},null,512),[[ee,i(E)]]),t[5]||(t[5]=y(" Hide small balances "))]),s("label",bt,[S(s("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>te(w)?w.value=e:null),type:"checkbox"},null,512),[[ee,i(w)]]),t[6]||(t[6]=y(" Value includes stake and delegated "))])])]),r(Ne,{fields:be,items:N.value,"per-page":50},Ie({"cell(icon)":m(({item:e})=>[s("img",{src:e.icon,class:"w-6"},null,8,vt)]),"cell(balance)":m(({item:e})=>[y(p(i(H)(e.balance)),1)]),"cell(usdValue)":m(({item:e})=>[y("$"+p(i(H)(e.usdValue,!0)),1)]),"cell(changePct)":m(({item:e})=>[s("span",{class:Le({"text-red-500":e.changePct<0,"text-green-500":e.changePct>0})},p(e.changePct.toFixed(2))+"%",3)]),"cell(stake)":m(({item:e})=>[e.stakingEnabled?S((a(),l("span",ht,[y(p(i(H)(e.stake)),1)])),[[_,{content:`Available: ${e.availableStake}<br>Locked: ${e.lockedStake}<br>Pending: ${e.pendingUnstake}`,html:!0}]]):(a(),l("span",gt,"--"))]),"cell(delegation)":m(({item:e})=>[e.delegationEnabled?S((a(),l("span",_t,[y(p(e.delegationsIn.plus(e.delegationsOut).plus(e.pendingUndelegations)),1)])),[[_,{content:`In: ${e.delegationsIn}<br>Out: ${e.delegationsOut}<br>Pending: ${e.pendingUndelegations}`,html:!0}]]):(a(),l("span",yt,"--"))]),_:2},[D.value?void 0:{name:"cell(actions)",fn:m(({item:e})=>[s("button",{class:"btn-sm mb-1 mr-1 mt-1",title:"Transfer",onClick:d=>_e(e.token)},[r(i(Ze),{class:"h-5 w-5"})],8,ft),s("button",{class:"btn-sm mb-1 mr-1 mt-1",title:"Transfer",onClick:d=>g({action:"transfer",symbol:e.symbol,available:e.balance})},[r(i(ze),{class:"h-5 w-5"})],8,wt),e.stakingEnabled&&e.balance>0?(a(),l("button",{key:0,class:"btn-sm mb-1 mr-1 mt-1",title:"Stake",onClick:d=>g({action:"stake",symbol:e.symbol,available:e.balance})},[r(i(Qe),{class:"h-5 w-5"})],8,xt)):b("",!0),e.availableStake>0?(a(),l("button",{key:1,class:"btn-sm mb-1 mr-1 mt-1",title:"Unstake",onClick:d=>g({action:"unstake",symbol:e.symbol,available:e.availableStake})},[r(i(Xe),{class:"h-5 w-5"})],8,Ct)):b("",!0),e.delegationEnabled&&e.availableStake>0?(a(),l("button",{key:2,class:"btn-sm mb-1 mr-1 mt-1",title:"Delegate",onClick:d=>g({action:"delegate",symbol:e.symbol,available:e.availableStake})},[r(i(Ye),{class:"h-5 w-5"})],8,Mt)):b("",!0),e.delegationsOut>0?(a(),l("button",{key:3,class:"btn-sm mb-1 mr-1 mt-1",title:"Undelegate",onClick:d=>g({action:"undelegate",symbol:e.symbol,available:e.delegationsOut})},[r(i(Ge),{class:"h-5 w-5"})],8,St)):b("",!0),e.symbol!=="SWAP.HIVE"&&!i(x).settings.deprecated_tokens.includes(e.symbol)?(a(),Q(c,{key:4,to:{name:"trade",params:{symbol:e.symbol}},class:"btn-sm mb-1 mr-1 mt-1",title:"Trade"},{default:m(()=>[r(i(qe),{class:"h-5 w-5"})]),_:2},1032,["to"])):b("",!0),e.pendingUnstake>0?(a(),l("button",{key:5,class:"btn-sm mb-1 mr-1 mt-1",title:"Pending Unstakes",onClick:d=>g({action:"pendingUnstakes",symbol:e.symbol,available:e.pendingUnstake})},[r(i(Ke),{class:"h-5 w-5"})],8,Vt)):b("",!0),r(c,{to:{name:"history",params:{symbol:e.symbol}},class:"btn-sm mb-1 mr-1 mt-1",title:"History"},{default:m(()=>[r(i(Je),{class:"h-5 w-5"})]),_:2},1032,["to"])]),key:"0"}]),1032,["items"])])),r(We)],64)}}};export{Pt as default};
