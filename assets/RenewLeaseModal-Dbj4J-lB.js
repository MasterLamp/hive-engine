import{r as c,ba as h,x as q,s as F,c as g,b0 as L,bj as O,I as T,o as y,a as k,w as f,b as V,h as M,f as s,k as P,Q as R,i as U,v as W,d as j,F as D,t as r,g as x,_ as z,bk as E,c1 as H,y as I}from"./index-CCPLilNe.js";import{_ as Q}from"./LoadingOverlay-CxOz52n3.js";const Y={class:"mb-3"},A={class:"flex items-center"},G={class:"mb-3"},J={class:"mb-3"},K=["disabled"],ee={__name:"RenewLeaseModal",props:{lease:{type:Object,required:!0}},setup(n){const p=c(!1),d=c(!1),u=c(!1),i=h(),B=q(),m=F(),a=n,o=c(1),l=g(()=>{if(!a.lease)return 0;const t=new L(a.lease.daily_payment).mul(o.value).mul(7).toFixed(i.precisions.get(a.lease.currency));return Number(t)}),w=g(()=>{if(!a.lease)return 0;const t=m.wallet.find(e=>e.symbol===a.lease.currency);return t?t.balance:0}),S={duration:{required:E,minValue:H(1)}},v=O(S,{duration:o}),_=async()=>{if(v.value.$touch(),v.value.$invalid)return;u.value=!0;const t=`renew ${a.lease.id}`;await m.requestTransfer({symbol:a.lease.currency,to:i.settings.account,quantity:I(l.value,i.precisions.get(a.lease.currency)),memo:t,eventName:"lease-renew-successful"}),u.value=!1},C=async()=>{d.value=!0,await m.fetchWallet(B.username,[a.lease.currency]),d.value=!1},N=()=>{o.value=1};return(t,e)=>{const $=T("Spinner");return y(),k(z,{modelValue:p.value,"onUpdate:modelValue":e[1]||(e[1]=b=>p.value=b),"modal-id":"renewLeaseModal",onBeforeOpen:C,onClosed:N},{title:f(()=>e[2]||(e[2]=[V("Renew Lease")])),default:f(()=>[M(Q,{show:d.value},{default:f(()=>[s("div",Y,[e[4]||(e[4]=s("label",{class:"mb-3 block"},"How long do you want to extend the lease for?",-1)),s("div",A,[P(s("input",{"onUpdate:modelValue":e[0]||(e[0]=b=>o.value=b),type:"number",step:"1",min:"1",class:R(["!rounded-r-none",U(v).duration.$error?"!dark:border-red-500 !focus:border-red-500 !focus:ring-red-500 !border-red-500":""])},null,2),[[W,o.value]]),e[3]||(e[3]=s("div",{class:"rounded-r-md border border-l-0 bg-gray-200 p-2 dark:border-gray-500 dark:bg-slate-600"}," Week(s) ",-1))])]),n.lease?(y(),j(D,{key:0},[s("div",G,"Total payment: "+r(l.value)+" "+r(n.lease.currency),1),s("div",J,"Your balance: "+r(w.value)+" "+r(n.lease.currency),1),s("button",{class:"btn",disabled:u.value||l.value<=0||l.value>w.value,onClick:_},[u.value?(y(),k($,{key:0})):x("",!0),V(" Pay "+r(l.value)+" "+r(n.lease.currency),1)],8,K)],64)):x("",!0)]),_:1},8,["show"])]),_:1},8,["modelValue"])}}};export{ee as default};
