const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/DepositGasFee-C1RSI1lV.js","assets/index-CCPLilNe.js","assets/index-Rzzs60cW.css"])))=>i.map(i=>d[i]);
import{r as m,u as ue,x as ie,q as ve,s as me,c as l,z as B,bj as ce,A as D,B as M,I as q,o,a as C,w as z,b as T,f as s,d as i,F as $,t as n,g as c,h as be,k as O,Q as j,i as y,v as U,L as W,_ as ge,bk as we,bZ as pe,bY as fe,a2 as ke,a3 as he,a4 as ye}from"./index-CCPLilNe.js";import{S as Z}from"./SearchSelect-BZ1OkDwa.js";const _e={class:"flex-grow"},Pe={key:0,class:"alert-warning mb-5 text-center font-bold"},Be={key:0,class:"alert-warning"},Ee={class:"mb-3"},Ae={class:"mb-3"},Se={class:"flex items-center"},Ce={class:"rounded-r-md border border-l-0 border-gray-500 bg-gray-200 p-2 dark:border-gray-500 dark:bg-slate-600"},Te={key:0,class:"mt-1 text-sm text-red-500"},We={class:"mb-3"},xe=["disabled"],Re={key:0,class:"mt-1 text-sm text-red-500"},Fe={key:1,class:"mb-3"},Ve={key:2,class:"flex items-center justify-between"},Le={class:"mb-3"},Me={class:"mb-3"},$e={key:3,class:"mb-3"},Oe={class:"mb-3"},Ue={key:4,class:"mb-3 text-sm"},Ie={__name:"Withdraw",setup(Ge){const J=he(()=>ye(()=>import("./DepositGasFee-C1RSI1lV.js"),__vite__mapDeps([0,1,2]))),_=m(!0),x=m(!1),E=ue(),Q=ie(),A=ve(),b=me(),t=m(null),v=m(""),k=m(""),P=m(""),h=m(0),r=l(()=>E.settings),R=l(()=>Q.username),K=l(()=>A.peggedTokens),G=l(()=>A.evmTokens),N=l(()=>b.evmGasFee),X=l(()=>b.gasFeeBalance),g=m(!1),d=m(null),F=m(0),Y=l(()=>{let a=[...K.value,r.value.eth_bridge.ethereum,r.value.bsc_bridge.bnb,r.value.polygon_bridge.pol,r.value.solana_bridge.solana];return r.value.eth_bridge.erc_20.enabled&&a.push({name:"Ethereum Tokens",symbol:"ERC20",pegged_token_symbol:"ERC20"}),r.value.bsc_bridge.bep_20.enabled&&a.push({name:"Binance Smart Chain Tokens",symbol:"BEP20",pegged_token_symbol:"BEP20"}),r.value.polygon_bridge.erc_20.enabled&&a.push({name:"Polygon Tokens",symbol:"POLY-ERC20",pegged_token_symbol:"POLY-ERC20"}),a=a.sort((e,f)=>e.name.localeCompare(f.name)).map(e=>({value:e.pegged_token_symbol,text:`${e.name} (${e.symbol})`,symbol:e.symbol})),[{value:null,text:"Please select a token"},...a]}),ee=l(()=>{const a=G.value.map(e=>({value:e.pegged_token_symbol,text:`${e.name} (${e.symbol})`}));return[{value:null,text:"Please select a token"},...a]}),I=l(()=>{const a=r.value.disabled_withdrawals.find(e=>e.symbol===t.value);return{disabled:!!a,...a}}),V=l(()=>{const{eth_bridge:{ethereum:{pegged_token_symbol:a}},bsc_bridge:{bnb:{pegged_token_symbol:e}},polygon_bridge:{pol:{pegged_token_symbol:f}}}=r.value;return[a,e,f]}),L=l(()=>{const{eth_bridge:{ethereum:{pegged_token_symbol:a}},bsc_bridge:{bnb:{pegged_token_symbol:e}},polygon_bridge:{pol:{pegged_token_symbol:f}}}=r.value;return{ETH:a,ERC20:a,BNB:e,BEP20:e,POL:f,"POLY-ERC20":f}[t.value]}),w=l(()=>({"SWAP.ETH":"eth",ERC20:"eth","SWAP.BNB":"bsc",BEP20:"bsc","SWAP.MATIC":"polygon","POLY-ERC20":"polygon"})[t.value]),ae=l(()=>{var e;let a=0;return v.value>0&&(a=B(v.value*.9925,8),[...V.value,"ERC20","BEP20","POLY-ERC20",(e=E.settings)==null?void 0:e.solana_bridge.solana.pegged_token_symbol].includes(t.value)?a=B(v.value*.99-N.value,8):t.value==="SWAP.BLURT"?a=B(a-.1,3):t.value==="SWAP.HIVE"&&(a=B(a,3))),a}),te=l(()=>{if(g.value&&d.value){const{symbol:a}=G.value.find(e=>e.pegged_token_symbol===d.value);return a}else if(t.value){const{symbol:a}=Y.value.find(e=>e.value===t.value);return a}}),S=l(()=>{let a=0;const e=new Map(r.value.minimum_withdrawals);return t.value&&(a=e.get(t.value)||0),a}),se=l(()=>["SWAP.EOS","SWAP.BTS"].includes(t.value)),le={withdrawAmount:{required:we,minValue(a){return S.value>0?a>=S.value:a>0}},withdrawAddress:{requiredIf:pe(()=>t.value!=="SWAP.HIVE"),validAddress:a=>{var e;return V.value.includes(t.value)||g.value?fe(a):t.value===((e=E.settings)==null?void 0:e.solana_bridge.solana.pegged_token_symbol)?/[1-9A-HJ-NP-Za-km-z]{32,44}/.test(a):!0}}},p=ce(le,{withdrawAmount:v,withdrawAddress:k}),oe=async()=>{p.value.$touch();const a=["ERC20","BEP20","POLY-ERC20"].includes(t.value)?d.value:t.value;let e=v.value;a==="SWAP.BLURT"&&(e=B(e,3)),p.value.$invalid||(x.value=!0,await b.requestTokenWithdrawal({amount:e.toString(),symbol:a,address:k.value.trim(),memo:P.value.trim(),network:w.value}),x.value=!1)},ne=async()=>{_.value=!0,r.value||await E.fetchSettings();const[a]=await Promise.all([M.getPendingWithdrawals(),A.fetchPeggedTokens()]);F.value=a.length,_.value=!1},re=()=>{t.value=null,v.value="",k.value="",P.value="",h.value=0},de=async()=>{const{open:a}=ke({component:J,attrs:{selectedToken:t.value,network:w.value,evmFeeSymbol:L.value}});await a()};return D(t,async a=>{if(_.value=!0,p.value.$reset(),g.value=!1,h.value=0,k.value="",a==="SWAP.HIVE"?k.value=R.value:V.value.includes(a)?await b.fetchGasFee(w.value,a):["ERC20","BEP20","POLY-ERC20"].includes(a)&&(g.value=!0,await Promise.all([A.fetchSupportedEvmTokens({network:w.value,withdrawal:!0}),b.fetchFeeBalance(w.value)])),P.value="",v.value="",!["ERC20","BEP20","POLY-ERC20"].includes(a)){const e=await M.getBalance(R.value,a);h.value=e?Number(e.balance):0}_.value=!1}),D(d,async a=>{p.value.$reset();const[e]=await Promise.all([M.getBalance(R.value,a),b.fetchGasFee(w.value,a),b.fetchFeeBalance(w.value)]);h.value=e?Number(e.balance):0}),(a,e)=>{const f=q("Loading"),H=q("Spinner");return o(),C(ge,{"modal-id":"withdrawModal",onBeforeOpen:ne,onClosed:re},{title:z(()=>e[8]||(e[8]=[T("Withdraw Tokens")])),default:z(()=>[s("div",_e,[_.value?(o(),C(f,{key:0,small:""})):(o(),i($,{key:1},[e[17]||(e[17]=s("div",{class:"alert-warning mb-5 font-bold"}," There is a 0.75% fee on withdrawals. For Ethereum, ERC-20, BNB, BEP-20, Polygon (POL), Polygon ERC-20 and Solana the withdrawal fee is 1% and you will also pay for the Ethereum / BSC / Polygon / Solana network gas fee. ",-1)),F.value>=15?(o(),i("div",Pe,[e[9]||(e[9]=T(" There are ")),s("strong",null,n(F.value),1),e[10]||(e[10]=T(" pending withdrawals waiting to be processed. So, your withdrawal might be delayed. "))])):c("",!0),be(Z,{modelValue:t.value,"onUpdate:modelValue":e[0]||(e[0]=u=>t.value=u),classes:"rounded-md mb-3","menu-class":"rounded-md",options:Y.value},null,8,["modelValue","options"]),t.value?(o(),i($,{key:1},[I.value.disabled?(o(),i("div",Be,n(I.value.reason),1)):(o(),i($,{key:1},[g.value?(o(),C(Z,{key:0,modelValue:d.value,"onUpdate:modelValue":e[1]||(e[1]=u=>d.value=u),classes:"rounded-md mb-3","menu-class":"rounded-md",options:ee.value},null,8,["modelValue","options"])):c("",!0),s("div",Ee,[e[11]||(e[11]=s("label",{class:"mb-2 block font-bold"},"Available Balance",-1)),s("div",{class:"cursor-pointer",onClick:e[2]||(e[2]=u=>v.value=h.value)},n(h.value)+" "+n(g.value?d.value:t.value),1)]),s("div",Ae,[e[12]||(e[12]=s("label",{for:"withdrawAmount",class:"mb-2 block font-bold"},"Withdraw Amount",-1)),s("div",Se,[O(s("input",{id:"withdrawAmount","onUpdate:modelValue":e[3]||(e[3]=u=>v.value=u),type:"number",step:"any",class:j([y(p).withdrawAmount.$error?"border-red-500 focus:border-red-500 focus:ring-red-500 dark:border-red-500":"","!rounded-r-none"])},null,2),[[U,v.value]]),s("div",Ce,n(g.value&&d.value?d.value:t.value),1)]),y(p).withdrawAmount.$error?(o(),i("div",Te," Please enter a valid amount to withdraw. ")):c("",!0)]),s("div",We,[e[13]||(e[13]=s("label",{for:"withdrawAddress",class:"mb-2 block font-bold"},"Withdraw Address",-1)),O(s("input",{id:"withdrawAddress","onUpdate:modelValue":e[4]||(e[4]=u=>k.value=u),type:"text",class:j([y(p).withdrawAddress.$error?"border-red-500 focus:border-red-500 focus:ring-red-500 dark:border-red-500":"",""]),disabled:t.value==="SWAP.HIVE"},null,10,xe),[[U,k.value]]),y(p).withdrawAddress.$error?(o(),i("div",Re," Please enter a valid receiving address. ")):c("",!0)]),se.value?(o(),i("div",Fe,[e[14]||(e[14]=s("label",{for:"withdrawMemo",class:"mb-2 block font-bold"},"Withdraw Memo",-1)),O(s("input",{id:"withdrawMemo","onUpdate:modelValue":e[5]||(e[5]=u=>P.value=u),type:"text",class:""},null,512),[[U,P.value]])])):c("",!0),g.value&&d.value?(o(),i("div",Ve,[s("div",Le,[e[15]||(e[15]=s("div",{class:"mb-2 font-bold"},"Required Gas Fee",-1)),s("div",null,n(N.value)+" "+n(L.value),1),s("a",{class:"cursor-pointer text-sm font-bold text-red-500",onClick:e[6]||(e[6]=W(u=>y(b).fetchGasFee(w.value,d.value),["prevent"]))},"Refresh")]),s("div",Me,[e[16]||(e[16]=s("div",{class:"mb-2 font-bold"},"Fee Balance",-1)),s("div",null,n(X.value)+" "+n(L.value),1),s("a",{class:"mr-5 cursor-pointer text-sm font-bold text-red-500",onClick:e[7]||(e[7]=W(u=>y(b).fetchFeeBalance(w.value),["prevent"]))},"Refresh"),s("a",{class:"cursor-pointer text-sm font-bold text-red-500",onClick:W(de,["prevent"])},"Deposit")])])):c("",!0),S.value>0?(o(),i("div",$e," Minimum withdrawal amount: "+n(S.value)+" "+n(t.value),1)):c("",!0),s("div",Oe,"You will receive (estimated): "+n(ae.value)+" "+n(te.value),1),t.value==="SWAP.BLURT"?(o(),i("div",Ue," SWAP.BLURT withdrawal has 0.100 SWAP.BLURT transaction fee of the Blurt Blockchain on top of the 0.75% withdrawal fee of Hive-Engine. ")):c("",!0),s("button",{class:"btn",disabled:`\r
                minimumWithdrawAmount > tokenBalance ||\r
                minimumWithdrawAmount > withdrawAmount\r
                withdrawAmount <= 0 ||\r
                withdrawAmount > tokenBalance ||\r
                (isEvmToken && evmGasFee > gasFeeBalance)\r
              `,onClick:W(oe,["prevent"])},[x.value?(o(),C(H,{key:0})):c("",!0),T(" "+n(" ")+" Withdraw "+n(g.value?d.value:t.value),1)])],64))],64)):c("",!0)],64))])]),_:1})}}};export{Ie as default};
