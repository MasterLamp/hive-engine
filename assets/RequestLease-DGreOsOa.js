import{o as d,d as b,f as a,u as J,ba as K,x as X,s as ee,r as u,c as g,y as C,bj as ae,a as W,w as q,b as y,h as R,F as V,k,e as D,t,b8 as M,Q as $,i as v,v as P,g as E,b$ as se,_ as te,bk as h,bl as le,bm as oe,c0 as ne,c1 as F}from"./index-CCPLilNe.js";import{_ as re}from"./LoadingOverlay-CxOz52n3.js";function ue(O,S){return d(),b("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[a("path",{"fill-rule":"evenodd",d:"M11.03 3.97a.75.75 0 0 1 0 1.06l-6.22 6.22H21a.75.75 0 0 1 0 1.5H4.81l6.22 6.22a.75.75 0 1 1-1.06 1.06l-7.5-7.5a.75.75 0 0 1 0-1.06l7.5-7.5a.75.75 0 0 1 1.06 0Z","clip-rule":"evenodd"})])}const de={class:"mb-3"},ie=["value"],ve={class:"mb-3"},ce={class:"mb-3"},me={class:"mb-3 block"},be={class:"mb-3"},fe={class:"flex items-center"},pe=["value"],ye={class:"mb-3"},ge={class:"mb-3 block"},ke={class:"flex items-center"},we={class:"mb-1"},_e={class:"mb-1"},he={class:"mb-3"},xe={key:0,class:"mb-3 text-red-400"},Ve=["disabled"],$e={class:"mb-3"},Pe={class:"mb-3 grid grid-cols-3 gap-4"},Se={class:"mt-10 flex items-center justify-between gap-4"},Be=["disabled"],Ue={__name:"RequestLease",setup(O){const S=J(),o=K(),B=X(),H=ee(),N=u(!1),L=u(!1),w=u(!1),x=u(1),r=u(null),f=u(""),c=u(500),_=u(""),l=u(""),m=u(1),U=g(()=>Array.from(o.assets.keys())),i=g(()=>Number(C(_.value*m.value,o.precisions.get(l.value)))),j=g(()=>o.metrics.get(r.value)*S.hivePrice*c.value),T=g(()=>(l.value==="SWAP.HIVE"?1:o.metrics.get(l.value))*S.hivePrice*i.value),A=g(()=>{if(!m.value||!T.value||!c.value)return 0;const n=365/(m.value*7+o.assets.get(r.value).cooldown)*.9*T.value/j.value*100;return C(n,2)}),I=g(()=>{const n=H.wallet.find(e=>e.symbol===l.value);return n?n.balance:0}),Z={asset:{required:h},beneficiary:{required:h,minLength:le(3),maxLength:oe(16)},amount:{required:h,numeric:ne,minValue:F(1)},payment:{required:h,greatetThanZero:n=>n>0},duration:{required:h,minValue:F(1)}},p=ae(Z,{asset:r,beneficiary:f,amount:c,payment:_,duration:m}),z=()=>{p.value.$touch(),!p.value.$invalid&&(x.value=2)},G=async()=>{w.value=!0;const n=`${m.value} ${f.value} ${c.value} ${r.value}`;await H.requestTransfer({symbol:l.value,to:o.settings.account,quantity:C(i.value,o.precisions.get(l.value)),memo:n,eventName:"lease-request-successful"}),w.value=!1},Q=async()=>{L.value=!0,B.isLoggedIn&&(f.value=B.username,await H.fetchWallet(B.username,o.currencies)),U.value.length>0&&(r.value=U.value[0]),o.currencies.length>0&&(l.value=o.currencies[0]),L.value=!1},Y=()=>{p.value.$reset(),x.value=1,f.value="",c.value=500,_.value="",m.value=1,w.value=!1};return(n,e)=>(d(),W(te,{modelValue:N.value,"onUpdate:modelValue":e[7]||(e[7]=s=>N.value=s),"modal-id":"requestLeaseModal",onBeforeOpen:Q,onClosed:Y},{title:q(()=>e[8]||(e[8]=[y("Request a Lease")])),default:q(()=>[R(re,{show:L.value},{default:q(()=>[x.value===1?(d(),b(V,{key:0},[a("div",de,[e[9]||(e[9]=a("label",{class:"mb-3 block"},"What you want to lease?",-1)),k(a("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>r.value=s),name:"asset"},[(d(!0),b(V,null,D(U.value,s=>(d(),b("option",{key:s,value:s},t(s),9,ie))),128))],512),[[M,r.value]])]),a("div",ve,[e[10]||(e[10]=a("label",{class:"mb-3 block"},"Which account do you want to lease for?",-1)),k(a("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>f.value=s),type:"text",class:$(v(p).beneficiary.$error?"!dark:border-red-500 !focus:border-red-500 !focus:ring-red-500 !border-red-500":"")},null,2),[[P,f.value]])]),a("div",ce,[a("label",me,"How much "+t(r.value)+" do you want to lease?",1),k(a("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>c.value=s),type:"number",step:"1",min:"1",class:$(v(p).amount.$error?"!dark:border-red-500 !focus:border-red-500 !focus:ring-red-500 !border-red-500":"")},null,2),[[P,c.value]])]),a("div",be,[e[11]||(e[11]=a("label",{class:"mb-3 block"},"How much do you want to pay per week?",-1)),a("div",fe,[k(a("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>_.value=s),type:"number",min:"0",class:$(["!rounded-r-none",v(p).payment.$error?"!dark:border-red-500 !focus:border-red-500 !focus:ring-red-500 !border-red-500":""])},null,2),[[P,_.value]]),k(a("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>l.value=s),name:"currency",class:"w-auto rounded-l-none border-l-0"},[(d(!0),b(V,null,D(v(o).currencies,s=>(d(),b("option",{key:s,value:s},t(s),9,pe))),128))],512),[[M,l.value]])])]),a("div",ye,[a("label",ge,"How long do you want to lease the "+t(r.value)+" for?",1),a("div",ke,[k(a("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>m.value=s),type:"number",step:"1",min:"1",class:$(["!rounded-r-none",v(p).duration.$error?"!dark:border-red-500 !focus:border-red-500 !focus:ring-red-500 !border-red-500":""])},null,2),[[P,m.value]]),e[12]||(e[12]=a("div",{class:"rounded-r-md border border-l-0 bg-gray-200 p-2 dark:border-gray-500 dark:bg-slate-600"}," Week(s) ",-1))])]),a("div",we,"Total payment: "+t(i.value)+" "+t(l.value),1),a("div",_e,"Estimated APR: "+t(A.value)+"%",1),a("div",he,"Your balance: "+t(I.value)+" "+t(l.value),1),i.value<v(o).minimumPayment.get(l.value)?(d(),b("div",xe," Total payment should be "+t(v(o).minimumPayment.get(l.value))+" "+t(l.value)+" or more. ",1)):E("",!0),a("button",{class:"btn",disabled:i.value>I.value||i.value<v(o).minimumPayment.get(l.value),onClick:z}," Next ",8,Ve)],64)):(d(),b(V,{key:1},[a("div",$e,[e[13]||(e[13]=a("h3",{class:"font-bold"},"Beneficiary",-1)),y(" "+t(f.value),1)]),a("div",Pe,[a("div",null,[e[14]||(e[14]=a("h3",{class:"font-bold"},"Amount",-1)),y(" "+t(c.value)+" "+t(r.value),1)]),a("div",null,[e[15]||(e[15]=a("h3",{class:"font-bold"},"Total Payment",-1)),y(" "+t(i.value)+" "+t(l.value),1)]),a("div",null,[e[16]||(e[16]=a("h3",{class:"font-bold"},"APR",-1)),y(" "+t(A.value)+"% ",1)])]),a("div",Se,[a("button",{onClick:e[6]||(e[6]=s=>x.value=1)},[R(v(ue),{class:"inline h-4 w-4","aria-hidden":"true"}),e[17]||(e[17]=y(" Go Back"))]),a("button",{class:"btn",disabled:w.value||i.value<=0,onClick:G},[w.value?(d(),W(se,{key:0})):E("",!0),y(" Pay "+t(i.value)+" "+t(l.value),1)],8,Be)])],64))]),_:1},8,["show"])]),_:1},8,["modelValue"]))}};export{Ue as default};
